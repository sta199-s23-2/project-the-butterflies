---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

```{r}
#| label: packages
#| message: false
#| warning: false

library(tidyverse)
library(tidymodels)
```

## INTRODUCTION - DONE

For this research project, we chose the topic of Olympic athletes from the sports of Swimming and Gymnastics. We are looking into the specific variables of age, height, and weight to see how these affect performance at a high level, and how these vary across the two sports. As such, our research question is: how do factors like age, height, and weight correlate with medal success rate across gymnastics and swimming? For this question, we hypothesize that the ideal height, weight, and age to win a medal will all be greater in swimming than in gymnastics.

To answer this research question, we will use the relevant variables of age, height, weight, medal won, sex, and sport. The numerical variables are age (in years), height (in centimeters), and weight (in kilograms). The character variables we are using are medal won, sex, and sport. For our analysis, we will filter the data set to only include gymnastics and swimming, the sports we are interested in analyzing.

We found this data set online at Kaggle, but the original data was from www.sports-reference.com. It was researched by a group of Olympic history enthusiasts and compiled into the data set format using R by Randi H. Griffin. The data was uploaded to the Kaggle website in 2018.

Using this data set, there are minimal to no ethical concerns, as this data was collected from a publicly accessible site. Additionally, all of this data was able be compiled by anyone, as Olympic athletes and their medals are also public information. We did not interview or collect any information ourselves, and their is no private health information or other private information available in this data. As such, there are no risks to the participants in our data collection and use of this data.

Each case in this data set corresponds to an individual athlete competing in an individual Olympic event between the years of 1896 and 2016. While we are only using the variables described above, this data set also includes team, year, games, city, and event for each case.

For this research topic, we will have to view which ages, heights, and weights have received medals. I would hypothesize that for each separate sport, there is a different normal distribution for ages, heights, and weights that have medal success rates, showing an ideal age, height, and weight for each sport we visualize.

# METHODOLOGY

## justify the choice of statistical method(s) used to answer your research question

To answer our research question, we used statistical methods of ____ 

```{r}
#| label: data
#| message: false
#| warning: false

olympic_data <- read_csv("athlete_events.csv")
```

```{r}
#| label: filter

data <- olympic_data |>
  filter(Sport == "Swimming" | Sport == "Gymnastics") |>
  select(Sex, Age, Height, Weight, Medal, Sport) |>
  filter(!is.na(Age)) |>
  filter(!is.na(Height)) |>
  filter(!is.na(Weight)) |>
  mutate(Category = case_when(
    Sex == "F" & Sport == "Gymnastics" ~ "Female Gymnastics",
    Sex == "F" & Sport == "Swimming" ~ "Female Swimming",
    Sex == "M" & Sport == "Gymnastics" ~ "Male Gymnastics",
    Sex == "M" & Sport == "Swimming" ~ "Male Swimming")) |>
  mutate(Points = case_when(Medal == "Gold" ~ 3,
                            Medal == "Silver" ~ 2,
                            Medal == "Bronze" ~ 1,
                            is.na(Medal) ~ 0)) 

data

```

```{r}
#| label: visualization

data |>
  ggplot(
    aes(x = Height, y = Weight, color = Category)
  ) +
  geom_point(alpha = 0.75, size = 0.5) +
  labs(x = "Height(cm)", y = "Weight(kg)", color = "Sport", title = "Height and weight of Olympic athletes \nby sport and gender")

```


```{r}
#| label: only-medalists

data |>
  filter(!is.na(Medal)) |>
  ggplot(
    aes(x = Height, y = Weight, color = Category)
  ) +
  geom_point(alpha = 0.75, size = 0.5) +
  labs(x = "Height(cm)", y = "Weight(kg)", color = "Sport", title = "Height and weight of Olympic medalists \nby sport and gender")

```


```{r}
data |>
  filter(!is.na(Medal)) |>
  ggplot(
    aes(x = Height, y = Weight, color = Medal)) +
  facet_wrap(vars(Category)) +
  geom_point(alpha = 0.5, size = 0.75) +
  scale_color_manual(
    values = c("Gold" = "#FFD700",
               "Silver" = "#C0C0C0",
               "Bronze" = "#CD7F32")) +
  labs(x = "Height(cm)", y = "Weight(kg)", color = "Medal")


```


```{r}
#| label: age-category-info

data |>
  filter(!is.na(Age)) |>
  slice_max(Age)

data |>
  filter(!is.na(Age)) |>
  slice_min(Age)
```

```{r}
#| label: age-categories
#what do yall think of the categories...?? Struggled w names a bit
data |>
  mutate(Age_Category = if_else(Age < 13, "Adolescent",
         if_else(Age < 18, "Teenager", 
         if_else(Age < 26, "Young Adult", "Later Adult"))))
```

```{r}


height_data <- data |>
  group_by(Height, Category) |>
  summarize(medal_success = sum(Points))
```

```{r}
height_data |>
  ggplot(
    aes(x = Height, y = medal_success, fill = Category)
  ) +
  facet_wrap(~ Category) +
  geom_col(binwidth = 1)
```

```{r}
weight_data <- data |>
  group_by(Weight, Category) |>
  summarize(medal_success = sum(Points))
```

```{r}
weight_data |>
  ggplot(
    aes(x = Weight, y = medal_success, fill = Category)
  ) +
  facet_wrap(~ Category) +
  geom_col(binwidth = 1)
```

```{r}
age_data <- data |>
  group_by(Age, Category) |>
  summarize(medal_success = sum(Points))
```

```{r}
age_data |>
  ggplot(
    aes(x = Age, y = medal_success, fill = Category)
  ) +
  facet_wrap(~ Category) +
  geom_col(binwidth = 1)
```

# RESULTS 

